name: Publish Packages
on: workflow_dispatch
env:
  om_ver_file: om_version
  origen_ver_file: origen_version
jobs:
  build_manylinux:
    strategy:
      fail-fast: false
      matrix:
        python-version: ${{ fromJSON(vars.PYTHON_VERSIONS_FOR_RELEASE) }}
    runs-on: ubuntu-latest
    steps:
      - name: Check out the repo
        uses: actions/checkout@v4
      - name: Run Docker container
        uses: addnab/docker-run-action@v3
        with:
          image: quay.io/pypa/manylinux2014_x86_64
          options: |
            --user root
            --volume ${{ github.workspace }}:/tmp/o2
            --env OM_VER_FILE=${{ env.om_ver_file }}
            --env ORIGEN_VER_FILE=${{ env.origen_ver_file }}
            --env RUST_VERSION=${{ fromJSON(vars.RUST_VERSION) }}
            --env PYTHON_VERSION=${{ matrix.python-version }}
          run: |
            source /tmp/o2/.github/workflows/setup_manylinux.sh
            
