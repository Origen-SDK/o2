name: Publish Packages
on: workflow_dispatch
env:
  om_ver_file: om_version
  origen_ver_file: origen_version
jobs:
  build_manylinux:
    strategy:
      fail-fast: false
      matrix:
        python-version: ${{ fromJSON(vars.PYTHON_VERSIONS_FOR_RELEASE) }}
    runs-on: ubuntu-latest
    steps:
      - name: Check out the repo
        uses: actions/checkout@v4
      - name: Run Docker container
        uses: addnab/docker-run-action@v3
        with:
          image: quay.io/pypa/manylinux2014_x86_64
          options: --user root
          run: |
            pwd
            echo "ROOT_DIR=$PWD" >> $GITHUB_ENV
            env
            echo "HOME=/root" >> $GITHUB_ENV
            curl https://sh.rustup.rs -sSf | sh -s -- -y
            echo "$HOME/.cargo/bin" >> $GITHUB_PATH
            rustup install ${{ fromJSON(vars.RUST_VERSION) }}
            rustup default ${{ fromJSON(vars.RUST_VERSION) }}
            rustc --version
            cargo --version
